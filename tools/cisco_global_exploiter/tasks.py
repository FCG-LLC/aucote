from tools.cisco_global_exploiter.base import CiscoGlobalExploiterBase
from tools.common.command_task import CommandTask


class CiscoGlobalExploiterTask(CommandTask):

    def __init__(self, stdin, *args, **kwargs):
        """
        Initialize variables

        Args:
            port (Port):
            *args:
            **kwargs:

        """
        super().__init__(command=CiscoGlobalExploiterBase(), *args, **kwargs)
        self.stdin = stdin

    def prepare_args(self):
        """
        Prepare aguments for command execution

        Returns:
            list

        """
        args = [str(self._port.node.ip), self.current_exploits[0].name[5:]]  # todo: exploit instead of current_exploits
        return args
