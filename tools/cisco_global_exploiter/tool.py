from tools.base import Tool
from tools.cisco_global_exploiter.tasks import CiscoGlobalExploiterTask


class CiscoGlobalExploiterTool(Tool):
    def __call__(self, *args, **kwargs):
        if self.port.is_ipv6 or self.port.is_physical or self.port.is_broadcast:
            return

        for exploit in self.exploits:
            if exploit.name in self.config.get('disabled_scripts'):
                continue
            self.executor.add_task(CiscoGlobalExploiterTask(executor=self.executor, port=self.port,
                                                            exploit=[exploit],stdin=self.config.get('scripts', {}).
                                                            get(exploit.name, {}).get('stdin', None)))
