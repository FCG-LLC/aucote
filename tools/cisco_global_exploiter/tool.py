"""
Contains main cge manager

"""
from tools.base import Tool
from tools.cisco_global_exploiter.tasks import CiscoGlobalExploiterTask


class CiscoGlobalExploiterTool(Tool):
    """
    This tool is responsible for exploiting using cge

    """
    def __call__(self, *args, **kwargs):
        """
        Filters out no-ipv4 ports and some dangerous exploits (DoS)

        Args:
            *args:
            **kwargs:

        Returns:
            None

        """
        if self.port.is_ipv6 or self.port.is_physical or self.port.is_broadcast:
            return

        for exploit in self.exploits:
            if exploit.name in self.config.get('disabled_scripts'):
                continue
            self.executor.add_task(CiscoGlobalExploiterTask(executor=self.executor, port=self.port,
                                                            exploits=[exploit]))
