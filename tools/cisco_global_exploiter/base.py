"""
Cisco global exploiter is exploit prepared for 14 well-known Cisco vulnerabilities.
"""
from tools.cisco_global_exploiter.parsers import CiscoGlobalExploiterOutputParser

from tools.common import Command


class CiscoGlobalExploiterBase(Command):
    """
    Base class. Executes command and handles calling exception.

    """
    COMMON_ARGS = tuple()
    NAME = 'cisco-global-exploiter'

    parser = CiscoGlobalExploiterOutputParser

    @classmethod
    def handle_exception(cls, exception, stderr):
        """
        Hnandles calling exception. Espacially interprets errors codes.

        Args:
            exception (CalledProcessError):
            stderr (list): list of output lines

        Returns:
            None

        """
        if exception.returncode in {1}:
            return None

        super(CiscoGlobalExploiterBase, cls).handle_exception(exception, stderr)
