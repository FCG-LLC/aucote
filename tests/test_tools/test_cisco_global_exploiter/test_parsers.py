from unittest import TestCase

from tools.cisco_global_exploiter.parsers import CiscoGlobalExploiterOutputParser

class CiscoGlobalExploiterOutputParserTest(TestCase):
    SUCCESSFUL_OUTPUT = "Target successfully exploited"
    UNSUCCESSFUL_OUTPUT = "unsuccessful"
    def setUp(self):
        self.parser = CiscoGlobalExploiterOutputParser

    def test_parse_successful(self):
        result = self.parser.parse(self.SUCCESSFUL_OUTPUT)
        expected = self.SUCCESSFUL_OUTPUT

        self.assertEqual(result, expected)

    def test_parse_unsuccessful(self):
        result = self.parser.parse(self.UNSUCCESSFUL_OUTPUT)
        expected = None

        self.assertEqual(result, expected)
