import subprocess
from unittest import TestCase
from unittest.mock import MagicMock

from tools.cisco_global_exploiter.base import CiscoGlobalExploiterBase


class CiscoGlobalExploiterBaseTest(TestCase):
    def setUp(self):
        self.command = CiscoGlobalExploiterBase()

    def test_handle_exception_return_code_1(self):
        self.exception = MagicMock()
        self.exception.returncode = 1

        result = self.command.handle_exception(self.exception, MagicMock())
        expected = None

        self.assertEqual(result, expected)

    def test_handle_exception(self):
        self.exception = subprocess.CalledProcessError(returncode=13, cmd='asd')

        self.assertRaises(subprocess.CalledProcessError, self.command.handle_exception, self.exception, MagicMock())