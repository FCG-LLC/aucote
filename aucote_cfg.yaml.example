# This is an example configuration file, which provides information about configurable options of aucote.
#
# pid_file: <str> - defines pid file path

pid_file: tmp/aucote.pid

# logging: Aucote logs a most of events in configuration files
#   file: <str> - This is path to the aucote log file
#   level: (debug|info|warning|error|critical) - This is the level of logging (default: info)
#   max_file_size: <int> - Maximum log file's size. After reach the limit, new file is created and old is archived.
#   max_files: <int> - Maximum amount of log files (with archived).
#   format: <str> - Format of log line. There are some variables which could be used:
#                   levelname - levelname of log line
#                   asctime - time of log line
#                   threadName - name of thred, which generate log line
#                   message - log message

logging:
    file: aucote.log
    level: info
    max_file_size: 10485760
    max_files: 5
    format: "%(levelname)s %(asctime)s %(threadName)s: %(message)s"

# fixtures:
#   exploits:
#     filename: <str> - Path to the exploits database

fixtures:
    exploits:
        filename: fixtures/exploits/exploits.csv

# kuduworker: Configuration of kudu.
#   queue:
#     address: <str> - URL to the kudu worker

kuduworker:
    queue:
        address: ipc:///tmp/skaza-pipeline.ipc

# This section provides configurations related to aucote as a service
# service:
#   scans:
#     threads: <int> - Number of threads to be running
#     rate: <int> - Rate in packets per seconds for scanning tool (e.g. masscan)
#     cron: <cron-like format> - This options defines how often aucote should run scans.
#                                Examples:
#                                   "*/5 * * * *" - run every 5 minutes
#                                   "1 2 3 4 5" - run every 3rd march at 2:01, if it is friday(5)
#                                More information: http://www.nncron.ru/help/EN/working/cron-format.htm
#                                                  https://en.wikipedia.org/wiki/Cron#CRON_expression
#     ports: <str> - Port range in format suit to the used tool eg. T:0-65535 for nmap/masscan
#     port_period: <period> - Minimal port scanning period
#     node_period: <period> - Minimal node scanning period
#     broadcast: (True|False) - Enable broadcast scanning if True (default)
#     physical: (True|False) - Enable scanning of aucote's host physical interfaces (e.g. eth0) if True (default)
#     networks: - list of networks, which should be scanned
#       - 127.0.0.1/32 - example ipv4 network
#       - ::1/128 - example ipv6 network

service:
    scans:
        threads: 10
        rate: 1000
        period: 12h
        cron: "0 22 * * *" # run every day at 22:00
        ports: T:0-65535,U:0-65535,S:65535 # TCP, UDP, SCTP: full range
        port_period: 15m
        node_period: 0s
        # networks: # Change it to proper values and uncomment
        #    - 127.0.0.1/32
        #    - ::1/128

# This section contains configuration related to topdis service
# topdis:
#   api:
#     host: <str|ipaddress> - host of api
#     port: <int> - port of api

topdis:
    api:
        host: 127.0.0.1
        port: 1234

# In this section there is configuration related to the tools used by the aucote
#
# This subsection shows common applications options
#
#    List of tools:
#        - nmap - security scanner
#        - masscan - port scanner based on nmap
#        - skipfish - active web application scanner
#        - hydra - parallelized login cracker
#        - aucote-http-headers - HTTP security headers scanner
#
# tools:
#   (nmap|masscan|hydra|skipfish|aucote-http-headers):
#     enable: (True|False) - Enable tool
#     cmd: <str> - Command used to run application
#     period: <str> - Defines how often use application
#     periods: - Defines how often using particular application modules (e.g. nmap scripts).
#                These values are higher priority than 'period'.
#       module1: <period> - Period for module1
#       module2: <period> - Period for module2
#
# This subsection provides app-specific options
#
# tools:
#   nmap: - This subsection contains nmap configuration
#     domains: - List of domains used by some scripts e.g. DNS
#       - <str>
#       - <str>
#
#   masscan: - This subsection contains masscan configuration
#     args: additional arguments for masscan e.g. outgoing interface
#       - <str>
#       - <str>
#
#   hydra: - This subsection contains thc-hydra configuration
#     loginfile: static/logins.hydra.txt
#     passwordfile: static/passwords.hydra.txt
#     enable: (True|False) - It is possible to disable this tool
#     disable_services: - List of disabled services, e.g. vnc
#       - <str>
#       - <str>
#
#   skipfish:
#     limit: 0:10:00 - Time limit of skipfish scan
#     threads: 5 - Amount of thread used by skipfish
#     tmp_directory: /tmp - Path to the temporary directory for reports processing


tools:
    nmap:
        cmd: nmap
        enable: True
        period: 1d
    masscan:
        cmd: masscan
    hydra:
        cmd: hydra
        loginfile: static/logins.hydra.txt
        passwordfile: static/passwords.hydra.txt
        enable: False
        period: 1d
        disable_services:
            - vnc
            - http
            - https
        period: 7d
    skipfish:
        cmd: skipfish
        enable: False
        limit: 0:10:00
        threads: 5
        tmp_directory: /tmp
        period: 7d
    aucote-http-headers:
        enable: True